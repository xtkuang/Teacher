<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="css/theory.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>
</head>
<body>
    <div class="container">
        <div class="behind">
            <div class="deCircle decoration1">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration2">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration3">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration4">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration5">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration6">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration7">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration8">
                <div class="inCircle"></div>
            </div>
            <div class="deCircle decoration9">
                <div class="inCircle"></div>
            </div>
        </div>

        
        <div class="main">

            <div class="nav">
                <div class="nav1">
                    <ul>
                        <li class="English">Theory</li>
                        <li class="Chinese">理论</li>
                    </ul>
                </div>
                <div class="nav2">
                    <ul>
                        <li class="English">Practice</li>
                        <li class="Chinese">实践</li>
                    </ul>
                </div>
            </div>

            <div class="content" id="content1"> 
                <div class="icon">

                    <svg width="26" height="17" viewBox="0 0 26 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18.3699 5.74399C18.3699 5.82399 18.2841 5.96399 18.1127 6.16399C17.9412 6.36399 17.7575 6.59999 17.5616 6.87199C17.3657 7.14399 17.182 7.43999 17.0105 7.75999C16.839 8.07999 16.7533 8.40799 16.7533 8.74399C16.7533 9.07999 16.839 9.40399 17.0105 9.71599C17.182 10.028 17.3657 10.312 17.5616 10.568C17.7575 10.824 17.9412 11.036 18.1127 11.204C18.2841 11.372 18.3699 11.48 18.3699 11.528V14.048C18.3699 14.32 18.2678 14.628 18.0637 14.972C17.8596 15.316 17.6065 15.64 17.3044 15.944C17.0023 16.248 16.6676 16.5 16.3002 16.7C15.9328 16.9 15.5858 17 15.2592 17H3.08617C2.6453 17 2.24116 16.924 1.87376 16.772C1.50637 16.62 1.18388 16.408 0.906288 16.136C0.628699 15.864 0.412344 15.544 0.257221 15.176C0.102098 14.808 0.0245361 14.408 0.0245361 13.976V3.63199C0.0245361 3.31199 0.0980154 2.97999 0.244974 2.63599C0.391933 2.29199 0.600124 1.97599 0.869548 1.68799C1.13897 1.39999 1.45738 1.15999 1.82478 0.967993C2.19218 0.775993 2.59631 0.679993 3.03719 0.679993H15.2103C15.6511 0.679993 16.0634 0.755993 16.4472 0.907993C16.8309 1.05999 17.1656 1.26799 17.4514 1.53199C17.7371 1.79599 17.9616 2.11199 18.1249 2.47999C18.2882 2.84799 18.3699 3.23999 18.3699 3.65599V5.74399ZM25.9872 3.48799V14.456C25.9872 14.808 25.8933 15.12 25.7055 15.392C25.5178 15.664 25.2361 15.8 24.8605 15.8C24.7299 15.8 24.5625 15.752 24.3584 15.656C24.1543 15.56 23.9502 15.448 23.7461 15.32C23.542 15.192 23.3501 15.064 23.1705 14.936C22.9909 14.808 22.8603 14.704 22.7786 14.624C22.5664 14.448 22.2439 14.144 21.8111 13.712C21.3784 13.28 20.9416 12.792 20.5008 12.248C20.0599 11.704 19.6721 11.144 19.3373 10.568C19.0026 9.99199 18.8352 9.46399 18.8352 8.98399C18.8352 8.50399 19.0149 7.95599 19.3741 7.33999C19.7333 6.72399 20.166 6.11999 20.6722 5.52799C21.1784 4.93599 21.7091 4.38799 22.2643 3.88399C22.8194 3.37999 23.2848 2.99999 23.6604 2.74399C23.8073 2.64799 24.0074 2.53199 24.2605 2.39599C24.5136 2.25999 24.7381 2.19199 24.934 2.19199C25.3749 2.19199 25.6606 2.31199 25.7913 2.55199C25.9219 2.79199 25.9872 3.08799 25.9872 3.43999V3.48799Z" fill="url(#paint0_linear_0_1046)"/>
                        <defs>
                        <linearGradient id="paint0_linear_0_1046" x1="13.0059" y1="0.679993" x2="13.0059" y2="17" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#3F8CFF"/>
                        <stop offset="1" stop-color="#4E3FFF"/>
                        </linearGradient>
                        </defs>
                    </svg>
                    <div class="text">短视频</div>
                </div>

                <div class="swiper mySwiper" id="swiper1">
                    <div class="swiper-wrapper" >
                    </div>
                    <!-- <div class="swiper-button-next" style="    z-index: 20;"></div>
                    <div class="swiper-button-prev" style="    z-index: 20;"></div> -->
                </div>

                <div class="swiper" id="swiper-side"> 
                    <div class="intro">
                    </div>
                    <!-- <div class="date"> 
                           发布时间：2023-01-23
                    </div> -->
                   
                </div>
               
            </div>

            <div class="content" id="content2"> 
                <div class="icon">

                    <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M23.3125 4.625C23.2386 4.625 23.1655 4.63955 23.0972 4.66782C23.029 4.69609 22.967 4.73752 22.9148 4.78975C22.8625 4.84199 22.8211 4.90399 22.7928 4.97224C22.7646 5.04049 22.75 5.11363 22.75 5.1875V22.0625C22.75 22.2117 22.6907 22.3548 22.5852 22.4602C22.4798 22.5657 22.3367 22.625 22.1875 22.625C22.0383 22.625 21.8952 22.5657 21.7898 22.4602C21.6843 22.3548 21.625 22.2117 21.625 22.0625V1.53125C21.6246 1.15842 21.4763 0.800976 21.2127 0.537344C20.949 0.273711 20.5916 0.125419 20.2188 0.125H1.65625C1.28342 0.125419 0.925976 0.273711 0.662344 0.537344C0.398711 0.800976 0.250419 1.15842 0.25 1.53125V23.4688C0.250419 23.8416 0.398711 24.199 0.662344 24.4627C0.925976 24.7263 1.28342 24.8746 1.65625 24.875H21.625C22.2215 24.8743 22.7935 24.6371 23.2153 24.2153C23.6371 23.7935 23.8743 23.2215 23.875 22.625V5.1875C23.875 5.11363 23.8605 5.04049 23.8322 4.97224C23.8039 4.90399 23.7625 4.84199 23.7102 4.78975C23.658 4.73752 23.596 4.69609 23.5278 4.66782C23.4595 4.63955 23.3864 4.625 23.3125 4.625ZM4.75 5.1875C4.74991 5.07087 4.78607 4.9571 4.85348 4.86193C4.92089 4.76676 5.01621 4.6949 5.12626 4.65628C5.23631 4.61767 5.35564 4.61422 5.46774 4.6464C5.57983 4.67859 5.67915 4.74482 5.75195 4.83594L9.25 9.20902V5.1875C9.25 5.03832 9.30926 4.89524 9.41475 4.78975C9.52024 4.68426 9.66332 4.625 9.8125 4.625C9.96168 4.625 10.1048 4.68426 10.2102 4.78975C10.3157 4.89524 10.375 5.03832 10.375 5.1875V10.8125C10.3751 10.9291 10.3389 11.0429 10.2715 11.1381C10.2041 11.2332 10.1088 11.3051 9.99874 11.3437C9.88869 11.3823 9.76936 11.3858 9.65726 11.3536C9.54517 11.3214 9.44585 11.2552 9.37305 11.1641L5.875 6.79098V10.8125C5.875 10.9617 5.81574 11.1048 5.71025 11.2102C5.60476 11.3157 5.46168 11.375 5.3125 11.375C5.16332 11.375 5.02024 11.3157 4.91475 11.2102C4.80926 11.1048 4.75 10.9617 4.75 10.8125V5.1875ZM16.5625 20.375H5.3125C5.16332 20.375 5.02024 20.3157 4.91475 20.2102C4.80926 20.1048 4.75 19.9617 4.75 19.8125C4.75 19.6633 4.80926 19.5202 4.91475 19.4148C5.02024 19.3093 5.16332 19.25 5.3125 19.25H16.5625C16.7117 19.25 16.8548 19.3093 16.9602 19.4148C17.0657 19.5202 17.125 19.6633 17.125 19.8125C17.125 19.9617 17.0657 20.1048 16.9602 20.2102C16.8548 20.3157 16.7117 20.375 16.5625 20.375ZM16.5625 15.875H5.3125C5.16332 15.875 5.02024 15.8157 4.91475 15.7102C4.80926 15.6048 4.75 15.4617 4.75 15.3125C4.75 15.1633 4.80926 15.0202 4.91475 14.9148C5.02024 14.8093 5.16332 14.75 5.3125 14.75H16.5625C16.7117 14.75 16.8548 14.8093 16.9602 14.9148C17.0657 15.0202 17.125 15.1633 17.125 15.3125C17.125 15.4617 17.0657 15.6048 16.9602 15.7102C16.8548 15.8157 16.7117 15.875 16.5625 15.875ZM16.5625 10.25H13.1875C13.0383 10.25 12.8952 10.1907 12.7898 10.0852C12.6843 9.97976 12.625 9.83669 12.625 9.6875C12.625 9.53832 12.6843 9.39524 12.7898 9.28975C12.8952 9.18426 13.0383 9.125 13.1875 9.125H16.5625C16.7117 9.125 16.8548 9.18426 16.9602 9.28975C17.0657 9.39524 17.125 9.53832 17.125 9.6875C17.125 9.83669 17.0657 9.97976 16.9602 10.0852C16.8548 10.1907 16.7117 10.25 16.5625 10.25ZM16.5625 5.75H13.1875C13.0383 5.75 12.8952 5.69074 12.7898 5.58525C12.6843 5.47976 12.625 5.33668 12.625 5.1875C12.625 5.03832 12.6843 4.89524 12.7898 4.78975C12.8952 4.68426 13.0383 4.625 13.1875 4.625H16.5625C16.7117 4.625 16.8548 4.68426 16.9602 4.78975C17.0657 4.89524 17.125 5.03832 17.125 5.1875C17.125 5.33668 17.0657 5.47976 16.9602 5.58525C16.8548 5.69074 16.7117 5.75 16.5625 5.75Z" fill="url(#paint0_linear_0_1048)"/>
                        <defs>
                        <linearGradient id="paint0_linear_0_1048" x1="12.0625" y1="0.125" x2="12.0625" y2="24.875" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#FF8A00"/>
                        <stop offset="1" stop-color="#FF5C00"/>
                        </linearGradient>
                        </defs>
                    </svg>
                    <div class="text">爆款新闻</div>
                </div>           

                <div class="swiper mySwiper" id="swiper2">
                    <div class="swiper-wrapper">
                    </div>
                    <div class="swiper-button-next" style="    z-index: 20;"></div>
                    <div class="swiper-button-prev" style="    z-index: 20;"></div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>

            <div class="content" id="content3">  
                <div class="icon">
                    <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.5 0.416656C19.1733 0.416656 24.5833 5.82667 24.5833 12.5C24.5833 19.1733 19.1733 24.5833 12.5 24.5833C10.3142 24.5866 8.16876 23.9942 6.29427 22.8699C6.10543 22.7581 5.91612 22.647 5.72636 22.5367L2.76957 23.3433C2.0929 23.5275 1.47242 22.9068 1.65699 22.2304L2.46235 19.2769C2.1506 18.7477 1.94639 18.3927 1.84489 18.2033C0.904528 16.4496 0.413796 14.49 0.416638 12.5C0.416638 5.82667 5.82665 0.416656 12.5 0.416656ZM9.60511 15.986C9.51359 15.9099 9.40798 15.8526 9.29431 15.8174C9.18064 15.7821 9.06113 15.7695 8.94262 15.7805C8.8241 15.7914 8.7089 15.8255 8.60358 15.881C8.49826 15.9364 8.40489 16.012 8.3288 16.1035C8.25272 16.1951 8.1954 16.3007 8.16013 16.4143C8.12486 16.528 8.11232 16.6475 8.12323 16.766C8.13414 16.8845 8.16829 16.9998 8.22372 17.1051C8.27916 17.2104 8.3548 17.3038 8.44632 17.3798C9.5843 18.3277 11.019 18.8458 12.5 18.8437C14.0001 18.8437 15.4223 18.3202 16.5527 17.3805C16.6456 17.3048 16.7226 17.2115 16.7792 17.106C16.8359 17.0004 16.871 16.8847 16.8826 16.7654C16.8942 16.6462 16.8821 16.5259 16.8469 16.4114C16.8117 16.2968 16.7541 16.1905 16.6776 16.0983C16.601 16.0062 16.5069 15.9302 16.4008 15.8746C16.2946 15.8191 16.1785 15.7852 16.0592 15.7748C15.9399 15.7644 15.8196 15.7778 15.7055 15.8141C15.5914 15.8505 15.4856 15.9091 15.3942 15.9866C14.5818 16.6635 13.5574 17.0332 12.5 17.0312C11.4423 17.0332 10.4176 16.6632 9.60511 15.986Z" fill="url(#paint0_linear_0_1050)"/>
                        <defs>
                        <linearGradient id="paint0_linear_0_1050" x1="12.5" y1="0.416656" x2="12.5" y2="24.5833" gradientUnits="userSpaceOnUse">
                        <stop stop-color="#ED41B3"/>
                        <stop offset="1" stop-color="#ED4141"/>
                        </linearGradient>
                        </defs>
                    </svg>
                    <div class="text">网评</div>                    
                </div>
                <div class="swiper mySwiper" id="swiper3">
                    <div class="swiper-wrapper">
                    </div>
                    <div class="swiper-button-next" style="    z-index: 20;"></div>
                    <div class="swiper-button-prev" style="    z-index: 20;"></div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>
        </div>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script>
    //因为后端返回的url中的&符号被处理了,所以在添加数据时先将&改成*提交给后端,后端返回时再讲*改回&
    function replaceUrl(url) {
        return url.replace(/\*/g, '&');
    }
    //预加载本地数据
    //网评
    textArrayLocal_comment=[]
    urlArrayLocal_comment=[]
    imgArrayLocal_comment=[]
    // let lengthLocal_comment

    textArrayLocal_comment_practical=[]
    urlArrayLocal_comment_practical=[]
    imgArrayLocal_comment_practical=[]

    textArray_comment=[]
    urlArray_comment=[]
    imgArray_comment=[]

    textArray_comment_practical=[]
    urlArray_comment_practical=[]
    imgArray_comment_practical=[]
   
    //爆款新闻
    textArrayLocal_news=[]
    imgArrayLocal_news=[]

    textArrayLocal_news_practical=[]
    imgArrayLocal_news_practical=[]


    textArray_news=[]
    imgArray_news=[]

    textArray_news_practical=[]
    imgArray_news_practical=[]
    //短视频
    textArrayLocal_video=[]
    imgArrayLocal_video=[]

    textArray_video=[]
    imgArray_video=[]

    textArrayLocal_video_practical=[]
    imgArrayLocal_video_practical=[]

    textArray_video_practical=[]
    imgArray_video_practical=[]

    //网评
    // 从localStorage中获取存储的数据,网页初始加载local数据
    function updateLocalComment(){
        if(localStorage.getItem("commentResponse")!==null){
            var commentData = JSON.parse(localStorage.getItem("commentResponse"));
            lengthLocal_comment=commentData.length
            let swiper=$("#swiper3 .swiper-wrapper")
            swiper.empty()
            for(let i=0;i<lengthLocal_comment;i++){
                swiper.append(`
                <div class="swiper-slide">

                    <div class="text" pos=`+i+`>
                        <label for="">
                        </label>
                        
                        <div class="tp">
                            <a href="#" target="_blank"></a>
                        </div>                               </div>
                    <div class="img"></div>

                </div>
                `)
            }

            // swiper3.slideTo(0,500,false) 

            for(let i=0;i<lengthLocal_comment;i++){

                textArrayLocal_comment[i]=commentData[i].content
                urlArrayLocal_comment[i]=commentData[i].url
                // imgUrlArrayLocal_comment[i]=commentData[i].picture
                // imgArrayLocal_comment[i]=commentData[i].picture_b64
            }

            for(let i=0;i<lengthLocal_comment;i++){
                $("#swiper3 [pos="+i+"] label").html(textArrayLocal_comment[i])
                $("#swiper3 [pos="+i+"] a").text("网页链接: "+urlArrayLocal_comment[i]).attr("href",urlArrayLocal_comment[i])
                $("#swiper3 [pos="+i+"] +.img").css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_comment[i]+"")
            }

        }
        else{
            console.log("Local Comment无数据!");
        }      
    }

    
    updateLocalComment()

    function updateLocalComment_practical(){
        if(localStorage.getItem("commentResponsePractical")!==null){
            var commentData = JSON.parse(localStorage.getItem("commentResponsePractical"));
            lengthLocal_comment=commentData.length
            let swiper=$("#swiper3 .swiper-wrapper")
            // console.log("长度"+commentData.length);
            swiper.empty()
            for(let i=0;i<lengthLocal_comment;i++){
                swiper.append(`
                <div class="swiper-slide">

                    <div class="text" pos=`+i+`>
                        <label for="">
                        </label>
                        
                        <div class="tp">
                            <a href="#" target="_blank"></a>
                        </div>                               </div>
                    <div class="img"></div>

                </div>
                `)
            }
            
            // let pag=`
            // <div class="swiper-pagination"></div>
            //         `
            // $(".swiper-pagination").remove()
            // $("#swiper3 .swiper-button-prev").after(pag)
            // swiper3.slideTo(0,500,false)
            for(let i=0;i<lengthLocal_comment;i++){

                textArrayLocal_comment_practical[i]=commentData[i].content
                
                urlArrayLocal_comment_practical[i]=commentData[i].url
                // imgUrlArrayLocal_comment_practical[i]=commentData[i].picture
                // imgArrayLocal_comment_practical[i]=commentData[i].picture_b64
            }

            for(let i=0;i<lengthLocal_comment;i++){
                $("#swiper3 [pos="+i+"] label").html(textArrayLocal_comment_practical[i])
                $("#swiper3 [pos="+i+"] a").text("网页链接: "+urlArrayLocal_comment_practical[i]).attr("href",urlArrayLocal_comment_practical[i])
                $("#swiper3 [pos="+i+"] +.img").css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_comment_practical[i]+"")
            }

        }
        else{
            console.log("Local Comment practical 无数据!");
        }      
    }


    var xhr = new XMLHttpRequest();
    xhr.open('GET', 'http://118.25.189.240:5000/api/comment_theory', true);
    xhr.responseType = 'json'; // 如果接口返回的是JSON数据
    xhr.onload = function() {
        //flag为1时表示本地存储没有数据要创建slides
        let flag=0
        if(localStorage.getItem("commentResponse")==null){
            flag=1
        }
        var commentResponse = xhr.response; // 获取服务器返回的数据
        console.log(commentResponse);
        lengthLocal_comment=commentResponse.length


        if(flag==1){
            let swiper=$("#swiper3 .swiper-wrapper")
            swiper.empty()
            for(let i=0;i<lengthLocal_comment;i++){
                swiper.append(`
                <div class="swiper-slide">

                    <div class="text" pos=`+i+`>
                        <label for="">
                        </label>
                        
                        <div class="tp">
                            <a href="#" target="_blank"></a>
                        </div>                               </div>
                    <div class="img"></div>

                </div>
                `)
            }
            swiper1.update()
            swiper2.update()
            swiper3.update()
        }

        //当前的各项参数数值
        for(let i=0;i<lengthLocal_comment;i++){
            textArray_comment[i]=commentResponse[i].content
            urlArray_comment[i]=replaceUrl(commentResponse[i].url)
            // imgUrlArray_comment[i]=commentResponse[i].picture
            imgArray_comment[i]=commentResponse[i].picture_b64
        }
        //当前的与local里的比较
        for(let i=0;i<lengthLocal_comment;i++){
            // if(imgUrlArray_comment[i]!=imgUrlArrayLocal_comment[i]){
                // console.log("comment图片更新");
                // imgUrlArrayLocal_comment[i]=imgUrlArray_comment[i]
            imgArrayLocal_comment[i]=imgArray_comment[i]
            $("#swiper3 [pos="+i+"] +.img").css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_comment[i]+"").hide().fadeIn()

            // }
            if(textArray_comment[i]!=textArrayLocal_comment[i]){
                console.log("comment文字更新");
                textArrayLocal_comment[i]=textArray_comment[i]
                $("#swiper3 [pos="+i+"] label").html(textArrayLocal_comment[i]).hide().fadeIn()

            }
            if(urlArray_comment[i]!=urlArrayLocal_comment[i]){
                console.log("comment链接更新");
                urlArrayLocal_comment[i]=urlArray_comment[i]
                $("#swiper3 [pos="+i+"] a").text("网页链接: "+urlArrayLocal_comment[i]).attr("href",urlArrayLocal_comment[i]).hide().fadeIn()

            }
        }
        for(let i=0;i<lengthLocal_comment;i++){
            delete commentResponse[i].picture_b64
        }
        localStorage.setItem('commentResponse', JSON.stringify(commentResponse));

    };
    xhr.send()

    var xhrp = new XMLHttpRequest();
    xhrp.open('GET', 'http://118.25.189.240:5000/api/comment_practical', true);
    xhrp.responseType = 'json'; // 如果接口返回的是JSON数据
    xhrp.onload = function() {

        var commentResponsePractical = xhrp.response; // 获取服务器返回的数据
        console.log(commentResponsePractical);
        // 存储数据到localStorage中
        lengthLocal_comment=commentResponsePractical.length

        //当前的各项参数数值
        for(let i=0;i<lengthLocal_comment;i++){
            textArray_comment_practical[i]=commentResponsePractical[i].content
            urlArray_comment_practical[i]=replaceUrl(commentResponsePractical[i].url)
            // imgUrlArray_comment_practical[i]=commentResponsePractical[i].picture
            imgArray_comment_practical[i]=commentResponsePractical[i].picture_b64
        }
        //当前的与local里的比较
        for(let i=0;i<lengthLocal_comment;i++){
            // if(imgUrlArray_comment_practical[i]!=imgUrlArrayLocal_comment_practical[i]){
            //     console.log("comment图片更新");
            // imgUrlArrayLocal_comment_practical[i]=imgUrlArray_comment_practical[i]
            imgArrayLocal_comment_practical[i]=imgArray_comment_practical[i]

            // $("#swiper3 [pos="+i+"] +.img").css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_comment_practical[i]+"").hide().fadeIn()

            // }
            if(textArray_comment_practical[i]!=textArrayLocal_comment_practical[i]){
                console.log("comment文字更新");
                textArrayLocal_comment_practical[i]=textArray_comment_practical[i]
                // $("#swiper3 [pos="+i+"] label").html(textArrayLocal_comment_practical[i]).hide().fadeIn()

            }

            if(urlArray_comment_practical[i]!=urlArrayLocal_comment_practical[i]){
                console.log("comment链接更新");
                urlArrayLocal_comment_practical[i]=urlArray_comment_practical[i]
                // $("#swiper3 [pos="+i+"] a").text("网页链接: "+urlArrayLocal_comment_practical[i]).attr("href",urlArrayLocal_comment_practical[i]).hide().fadeIn()

            }
        }
        for(let i=0;i<lengthLocal_comment;i++){
            delete commentResponsePractical[i].picture_b64
        }
        
        // $('.abc').css("background-image","url(data:image/jpeg;base64,"+img+")")
        localStorage.setItem('commentResponsePractical', JSON.stringify(commentResponsePractical));
    };
    xhrp.send()

    //爆款新闻
    // 从localStorage中获取存储的数据,网页初始加载local数据
    function updateLocalNews(){
        if(localStorage.getItem("newsResponse")!==null){
            var newsData = JSON.parse(localStorage.getItem("newsResponse"));
            lengthLocal_news=newsData.length
            let swiper=$("#swiper2 .swiper-wrapper")
            swiper.empty()
            for(let i=0;i<lengthLocal_news;i++){
                swiper.append(`
                <div class="swiper-slide">
                    <div class="img"></div>
                    <div class="text " pos=`+i+`>
                        <label >
                        </label>
                    </div>
                </div>
                `)
            }
            for(let i=0;i<lengthLocal_news;i++){

                textArrayLocal_news[i]=newsData[i].content
                // urlArrayLocal_news[i]=newsData[i].url
                // imgUrlArrayLocal_news[i]=newsData[i].picture
                // imgArrayLocal_news[i]=newsData[i].picture_b64
            }

            for(let i=0;i<lengthLocal_news;i++){
                $("#swiper2 [pos="+i+"] label").html(textArrayLocal_news[i])
                // $("#swiper3 [pos="+i+"] a").text("网页链接: "+urlArrayLocal_news[i]).attr("href",urlArrayLocal_news[i])
                $("#swiper2 [pos="+i+"]").siblings().css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_news[i]+"")
            }
            // let swiper3=$("#swiper3 .swiper-slide-active")
            // let pos=swiper3.attr("pos")
            // $(".boxtext span").html(textArrayLocal[fix])
            // $(".name span").html(nameArrayLocal[fix])
            // $(".major span").html(majorArrayLocal[fix])
            // $(".photoHolder .photo .img").css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal[fix]+"")
        }
        else{
            console.log("Local news无数据!");
        }      
    }

    updateLocalNews()

    function updateLocalNews_practical(){
        if(localStorage.getItem("newsResponsePractical")!==null){
            var newsData = JSON.parse(localStorage.getItem("newsResponsePractical"));
            lengthLocal_news=newsData.length
            let swiper=$("#swiper2 .swiper-wrapper")
            // console.log("长度"+commentData.length);
            swiper.empty()
            for(let i=0;i<lengthLocal_news;i++){
                swiper.append(`
                <div class="swiper-slide">
                    <div class="img"></div>
                    <div class="text " pos=`+i+`>
                        <label >
                        </label>
                        
                    </div>
                </div>
                `)
            }
            for(let i=0;i<lengthLocal_news;i++){

                textArrayLocal_news_practical[i]=newsData[i].content
                // urlArrayLocal_news[i]=newsData[i].url
                // imgUrlArrayLocal_news_practical[i]=newsData[i].picture
                // imgArrayLocal_news_practical[i]=newsData[i].picture_b64
            }

            for(let i=0;i<lengthLocal_news;i++){
                $("#swiper2 [pos="+i+"] label").html(textArrayLocal_news_practical[i])
                // $("#swiper3 [pos="+i+"] a").text("网页链接: "+urlArrayLocal_news[i]).attr("href",urlArrayLocal_news[i])
                $("#swiper2 [pos="+i+"]").siblings().css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_news_practical[i]+"")
            }
           
        }
        else{
            console.log("Local news无数据!");
        }      
    }

    //爆款新闻
    var xhr1 = new XMLHttpRequest();
    xhr1.open('GET', 'http://118.25.189.240:5000/api/news_theory', true);
    xhr1.responseType = 'json'; // 如果接口返回的是JSON数据
    xhr1.onload = function() {
        let flag=0
        if(localStorage.getItem("newsResponse")==null){
            flag=1
        }
        var newsResponse = xhr1.response; // 获取服务器返回的数据
        // console.log("newsResponse");
        console.log(newsResponse);

        lengthLocal_news=newsResponse.length

        if(flag==1){
            let swiper=$("#swiper2 .swiper-wrapper")
            swiper.empty()
            for(let i=0;i<lengthLocal_news;i++){
                swiper.append(`
                <div class="swiper-slide">
                    <div class="img"></div>
                    <div class="text " pos=`+i+`>
                        <label >
                        </label>
                        
                    </div>
                </div>
                `)
            }
            swiper1.update()
            swiper2.update()
            swiper3.update()
        }

        //当前的各项参数数值
        for(let i=0;i<lengthLocal_news;i++){
            textArray_news[i]=newsResponse[i].content
            // urlArray_news[i]=newsResponse[i].url
            // imgUrlArray_news[i]=newsResponse[i].picture
            imgArray_news[i]=newsResponse[i].picture_b64
        }
        //当前的与local里的比较
        for(let i=0;i<lengthLocal_news;i++){
            // if(imgUrlArray_news[i]!=imgUrlArrayLocal_news[i]){
            //     console.log("news图片更新");
            //     imgUrlArrayLocal_news[i]=imgUrlArray_news[i]
            imgArrayLocal_news[i]=imgArray_news[i]

            $("#swiper2 [pos="+i+"]").siblings().css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_news[i]+"").hide().fadeIn()

            
            if(textArray_news[i]!=textArrayLocal_news[i]){
                console.log("news文字更新");
                textArrayLocal_news[i]=textArray_news[i]
                $("#swiper2 [pos="+i+"] label").html(textArrayLocal_news[i]).hide().fadeIn()

            }

        }

        for(let i=0;i<lengthLocal_news;i++){
            delete newsResponse[i].picture_b64
        }
        // 存储数据到localStorage中
        localStorage.setItem('newsResponse', JSON.stringify(newsResponse));

    };
    xhr1.send()

    var xhr1p = new XMLHttpRequest();
    xhr1p.open('GET', 'http://118.25.189.240:5000/api/news_practical', true);
    xhr1p.responseType = 'json'; // 如果接口返回的是JSON数据
    xhr1p.onload = function() {
        var newsResponsePractical = xhr1p.response; // 获取服务器返回的数据

        console.log(newsResponsePractical);

        lengthLocal_news=newsResponsePractical.length

        //当前的各项参数数值
        for(let i=0;i<lengthLocal_news;i++){
            textArray_news_practical[i]=newsResponsePractical[i].content
            // urlArray_news[i]=newsResponse[i].url
            // imgUrlArray_news_practical[i]=newsResponsePractical[i].picture
            imgArray_news_practical[i]=newsResponsePractical[i].picture_b64
        }
        //当前的与local里的比较
        for(let i=0;i<lengthLocal_news;i++){
            // if(imgUrlArray_news_practical[i]!=imgUrlArrayLocal_news_practical[i]){
            //     console.log("news图片更新");
            //     imgUrlArrayLocal_news_practical[i]=imgUrlArray_news_practical[i]
            imgArrayLocal_news_practical[i]=imgArray_news_practical[i]
                // $("#swiper2 [pos="+i+"]").siblings().css("background-image","url(data:image/jpeg;base64,"+imgArrayLocal_news[i]+"").hide().fadeIn()
            // }
            if(textArray_news_practical[i]!=textArrayLocal_news_practical[i]){
                console.log("news文字更新");
                textArrayLocal_news_practical[i]=textArray_news_practical[i]
                // $("#swiper2 [pos="+i+"] label").html(textArrayLocal_comment[i]).hide().fadeIn()

            }

        }
        for(let i=0;i<lengthLocal_news;i++){
            delete newsResponsePractical[i].picture_b64
        }
        // 存储数据到localStorage中
        localStorage.setItem('newsResponsePractical', JSON.stringify(newsResponsePractical));
    };
    xhr1p.send()

    //短视频
    // 从localStorage中获取存储的数据,网页初始加载local数据
    function updateLocalVideo(){
        if(localStorage.getItem("videoResponse")!==null){
            var videoData = JSON.parse(localStorage.getItem("videoResponse"));
            let length=videoData.length
            let swiper=$("#swiper1 .swiper-wrapper")
            swiper.empty()
            for(let i=0;i<length;i++){
                let a=i+1

                swiper.append(`
                <div class="swiper-slide" index=`+a+`>
                    <div class="img" ></div>
                </div>
                `)


            }
            for(let i=0;i<length;i++){

                textArrayLocal_video[i]=videoData[i].content
                // urlArrayLocal_video[i]=videoData[i].url
                // imgUrlArrayLocal_video[i]=videoData[i].picture
                // imgArrayLocal_video[i]=videoData[i].picture_b64
            }

            for(let i=1;i<=length;i++){
                $("#swiper1 [index="+i+"] .img").css("background-image","linear-gradient(0deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),url(data:image/jpeg;base64,"+imgArrayLocal_video[i-1]+"")
            }


            
        }
        else{
            console.log("Local video无数据!");
        }      
    }

    updateLocalVideo()
    
    function updateLocalVideo_practical(){
        if(localStorage.getItem("videoResponsePractical")!==null){
            var videoData = JSON.parse(localStorage.getItem("videoResponsePractical"));
            let length=videoData.length
            let swiper=$("#swiper1 .swiper-wrapper")
            swiper.empty()
            for(let i=0;i<length;i++){
                let a=i+1

                swiper.append(`
                <div class="swiper-slide" index=`+a+` >
                    <div class="img" ></div>
                </div>
                `)

            }
            for(let i=0;i<length;i++){

                textArrayLocal_video_practical[i]=videoData[i].content
                // urlArrayLocal_video[i]=videoData[i].url
                // imgUrlArrayLocal_video[i]=videoData[i].picture
                // imgArrayLocal_video[i]=videoData[i].picture_b64
            }

            for(let i=1;i<=length;i++){
                $("#swiper1 [index="+i+"] .img").css("background-image","linear-gradient(0deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),url(data:image/jpeg;base64,"+imgArrayLocal_video_practical[i-1]+"")
            }

            introUpdate(length,2)
            
        }
        else{
            console.log("Local video无数据!");
        }      
    }

    var xhr2 = new XMLHttpRequest();
    xhr2.open('GET', 'http://118.25.189.240:5000/api/video_theory', true);
    xhr2.responseType = 'json'; // 如果接口返回的是JSON数据
    xhr2.onload = function() {
        let flag=0
        if(localStorage.getItem("videoResponse")==null){
            flag=1
        }
        var videoResponse = xhr2.response; // 获取服务器返回的数据
        console.log(videoResponse);

        let length=videoResponse.length
        if(flag==1){
            let swiper=$("#swiper1 .swiper-wrapper")
            swiper.empty()
            for(let i=0;i<length;i++){
                let a=i+1
                if(i==0){
                    swiper.append(`
                    <div class="swiper-slide" index=`+a+` flag="1">
                        <div class="img" ></div>
                    </div>
                `)
                }
                else{
                    swiper.append(`
                    <div class="swiper-slide" index=`+a+` flag="0">
                            <div class="img" ></div>
                    </div>
                `)
                }
            }
            swiper1.update()
            swiper2.update()
            swiper3.update()
        }
        //当前的各项参数数值
        for(let i=0;i<length;i++){
            textArray_video[i]=videoResponse[i].content
            // urlArray_video[i]=videoResponse[i].url
            // imgUrlArray_video[i]=videoResponse[i].picture
            imgArray_video[i]=videoResponse[i].picture_b64
        }
        //当前的与local里的比较
        for(let i=1;i<=length;i++){
            // if(imgUrlArray_video[i-1]!=imgUrlArrayLocal_video[i-1]){
            //     console.log("video图片更新");
                // imgUrlArrayLocal_video[i-1]=imgUrlArray_video[i-1]
            imgArrayLocal_video[i-1]=imgArray_video[i-1]

            $("#swiper1 [index="+i+"] .img").css("background-image","linear-gradient(0deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),url(data:image/jpeg;base64,"+imgArrayLocal_video[i-1]+"").hide().fadeIn()
            // }
        }

        let active=$("#swiper1 [flag=1]")
        index=active.attr("index")-1
        let intro=$(".intro")
        if(textArray_video[index]!=textArrayLocal_video[index]){
            console.log("video文字更新");
            textArrayLocal_video[index]=textArray_video[index]
            intro.html(textArrayLocal_video[index]).hide().fadeIn();
        }

        for(let i=0;i<length;i++){
            delete videoResponse[i].picture_b64
        }
        localStorage.setItem('videoResponse', JSON.stringify(videoResponse));

    };

    xhr2.send()

    var xhr2p = new XMLHttpRequest();
    xhr2p.open('GET', 'http://118.25.189.240:5000/api/video_practical', true);
    xhr2p.responseType = 'json'; // 如果接口返回的是JSON数据
    xhr2p.onload = function() {

        var videoResponsePractical = xhr2p.response; // 获取服务器返回的数据
        console.log(videoResponsePractical);

        let length=videoResponsePractical.length
    
        //当前的各项参数数值
        for(let i=0;i<length;i++){
            textArray_video_practical[i]=videoResponsePractical[i].content
            // urlArray_video[i]=videoResponse[i].url
            // imgUrlArray_video[i]=videoResponse[i].picture
            imgArray_video_practical[i]=videoResponsePractical[i].picture_b64
        }
        //当前的与local里的比较
        for(let i=1;i<=length;i++){
            // if(imgUrlArray_video[i-1]!=imgUrlArrayLocal_video[i-1]){
            //     console.log("video图片更新");
                // imgUrlArrayLocal_video[i-1]=imgUrlArray_video[i-1]
            imgArrayLocal_video_practical[i-1]=imgArray_video_practical[i-1]

            // $("#swiper1 [index="+i+"] .img").css("background-image","linear-gradient(0deg, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),url(data:image/jpeg;base64,"+imgArrayLocal_video[i-1]+"").hide().fadeIn()
            // }
        }

        for(let i=0;i<length;i++){
            delete videoResponsePractical[i].picture_b64
        }
        localStorage.setItem('videoResponsePractical', JSON.stringify(videoResponsePractical));

    };

    xhr2p.send()

    function flagUpdate(){
        //choice 为1表示理论部分,为2表示实践部分
        //给active元素赋flag值
        let i=0
        $("#swiper1 .swiper-slide").each(function(){
            if(i==0){
                $(this).attr("flag","1")
            }
            else{
                $(this).attr("flag","0")
            }
            i=i+1
        })
        // for(let i=1;i<=length;i++){
        //     if(i==1){
        //         $("#swiper1 [index="+i+"]").attr("flag",1)
        //     }
        //     else{
        //         $("#swiper1 [index="+i+"]").attr("flag",0)
        //     }
        // }

    }

    flagUpdate()

    function introUpdate(choice){
        //更新文字intro
        let active=$("#swiper1 [flag=1]")
        let intro=$(".intro")
        let indexx=active.attr("index")-1
        if(choice==1){
            intro.html(textArrayLocal_video[indexx]).hide().fadeIn()
        }
        else if(choice==2){
            intro.html(textArrayLocal_video_practical[indexx]).hide().fadeIn()
        }
    }
    
    introUpdate(1)

    let fix_choice=1 //判断在当前页面轮播图更新理论还是实践内容

    const swiper1 = new Swiper('#swiper1', {
        grabCursor: true,
        slideToClickedSlide:true,
        lazy: {
                loadPrevNext: true,
            },
        slidesPerView: "2.5",
        coverflowEffect: {
            rotate: 0,
            stretch: -150,
            depth: 400,
            modifier: 1,
            spaceBetween: 20,
            slideShadows: false,
        },
        spaceBetween:40,
        loop:true,
        centeredSlides: false,
        on:{
        slideChangeTransitionStart: function(){

            setTimeout(function() {

            }, 100);

            let active=$("#swiper1 .swiper-slide-active")
            $("#swiper1 .swiper-slide").each(function(){
                $(this).attr("flag","0")
            })
            active.attr("flag","1")
            introUpdate(fix_choice)
            },
        },

    });

    const swiper2 = new Swiper('#swiper2', {

        // loop:true,
        lazy: {
            loadPrevNext: true,
            loadOnTransitionStart: true,
        },
        pagination: {
        el: ".swiper-pagination",
        type: "fraction",
        renderFraction: function (currentClass, totalClass) {
          return '<span class="' + currentClass + '"></span>' +
                 ' of ' +
                 '<span class="' + totalClass + '"></span>';
        },
        },

        spaceBetween: 20,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",

            disabledClass: 'my-button-disabled',
        },


    });

    const swiper3 = new Swiper('#swiper3', {

        // loop:true,
        lazy: {
            loadPrevNext: true,
        },
        pagination: {
        el: ".swiper-pagination",
        type: "fraction",
        renderFraction: function (currentClass, totalClass) {
          return '<span class="' + currentClass + '"></span>' +
                 ' of ' +
                 '<span class="' + totalClass + '"></span>';
        },
        },

      
        
        spaceBetween: 40,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",

            disabledClass: 'my-button-disabled',
        },


    });


    $(".nav1").click(function(){
        $(".nav1 .Chinese").css("font-weight","500").css("font-size","36px").css("line-height","50px")
        $(".nav2 .Chinese").css("font-weight","400").css("font-size","28px").css("line-height","39px")
        fix_choice=1
        
        updateLocalVideo()
        updateLocalNews()
        updateLocalComment()

        swiper1.update()
        swiper2.update()
        swiper3.update()
        // swiper1.slideToLoop(0,500,false)
        swiper1.params.loop=true
        swiper1.params.centeredSlides=false
        swiper1.update()
        flagUpdate()
        introUpdate(fix_choice)
        $(".content").hide().fadeIn()
    })

    $(".nav2").click(function(){
        $(".nav2 .Chinese").css("font-weight","500").css("font-size","36px").css("line-height","50px")
        $(".nav1 .Chinese").css("font-weight","400").css("font-size","28px").css("line-height","39px")
        fix_choice=2
        
        updateLocalVideo_practical()
        updateLocalNews_practical()
        updateLocalComment_practical()

        swiper1.update()
        swiper2.update()
        swiper3.update()
        // swiper1.slideToLoop(0,500,false)
        swiper1.params.loop=false
        swiper1.params.centeredSlides=true
        swiper1.update()
        flagUpdate()
        introUpdate(fix_choice)
        $(".content").hide().fadeIn()
        
    })
</script>

</html>
